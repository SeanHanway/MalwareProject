import os
import winreg
import shutil


class UndoWorm:
    evil_file_location = os.environ["Public"] + "\\WindowsExplorer.exe"
    if os.path.exists(evil_file_location):
        os.remove(evil_file_location)
    else:
        print("The file does not exist")

    keyVal = r'SOFTWARE\Microsoft\Windows\CurrentVersion\Run'
    key = winreg.OpenKey(winreg.HKEY_CURRENT_USER, keyVal, 0, winreg.KEY_ALL_ACCESS)
    winreg.DeleteValue(key, 'update')
    winreg.CloseKey(key)
    print("sucess")

    curr_dir = os.getcwd()
    dir = "__pycache__/"
    path = os.path.join(curr_dir, dir)
    shutil.rmtree(path)
    for f in os.listdir(curr_dir):
        if f.startswith('.'):
            os.remove(f)
            print("sucess")
